%
% These are special environments for adding extra information about
% code snippets which can be later extracted and used to generate test
% codes for automated testing.
%
% During LaTeX compilation, the enviroments defined in this file throw
% away all text within the scope of the environment, with the
% exception of 'chapelprintoutput' which prints the output (and is
% also extracted for testing purposes).
%
% Usage:
%
% - chapelpre (REQUIRED)
%   This marks the start of a test.   Any Chapel code in this scope
%   is put *before* the code in the chapel|chapelcode scope.  The
%   first line of the scope may specify a test name via a LaTeX
%   style comment (strongly recommended).
%
% - chapelcode|chapel
%   This is the part of the code that is in the spec.
%   
% - chapelpost
%   Any Chapel code in this scope is put *after* the code in the
%   chapel|chapelcode scope.
%
% - chapelfuture
% - chapelcompopts
% - chapelexecopts
%   The lines in these scopes are put directly into the appropriate file.
%
% - chapeloutput|chapelprintoutput (REQUIRED)
%   These environment provide the test output (.good files).  There can be
%   multiple such environments, and the filename is specified by a LaTeX
%   style comment preceeding the contents of the output.  The
%   'chapelprintoutput' scope is also outptted in the spec itself and
%   thus may contain LaTeX formatting (see GENERAL CAVEATS below)
%   

%
% GENERAL CAVEATS:
%
% - Because the chapelprintoutput enviroment must used LaTeX
%   formatting, the script that extracts the tests must removed any
%   LaTeX specific formatting.
%
% - Using a backslash or other special LaTeX characters may also be
%   needed (e.g., \_ or \#) in the other environments for LaTex
%   parsing purposes.  Such characters ar considered fragile and may
%   lead to unexpected results.
%

%
% Gobble up the text in this new box.  The text in each environment is
% dropped on the floor during LaTeX compilation.
%
\newsavebox{\teststuff}

%
% Any additional lines needed for the code snippet to run/compile
% (before and after the chapel code segment)
%
\newenvironment{chapelpre} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}

\newenvironment{chapelpost} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}


%
% .future file
%
\newenvironment{chapelfuture} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}

%
% .compopts file
%
\newenvironment{chapelcompopts} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}

%
% .execopts file
%
\newenvironment{chapelexecopts} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}


%
% .good file
% To get more than one file, use a LaTeX style comment to name the
% .good file
%
\newenvironment{chapeloutput} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}

%
% .prediff file
%
\newenvironment{chapelprediff} {\begin{lrbox}{\teststuff}
\begin{minipage}{6in}}
{\end{minipage}\end{lrbox}}

%
% .good file that is printed in the text of the Spec
% To get more than one file, use a LaTeX style comment to name the
% .good file
%
\newenvironment{chapelprintoutput} {
\begin{quote}
}{
\end{quote}
}
